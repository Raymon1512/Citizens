jQuery(function(){jQuery.expr[':'].externallink=function(obj){if(bEmailMsg==true){return obj.href.match(/^mailto\:/)||!IsApprovedURL(obj.href);}
else{return!IsApprovedURL(obj.href);}};jQuery('a:externallink').addClass('externallink');if(disableRightClick){jQuery('.externallink').not('[href*="mailto"]').bind('contextmenu',function(e){return false;});}
jQuery('.externallink').click(function(){var strLink=jQuery(this).attr('href');var strTarget=jQuery(this).attr('target');jQuery(this).ShowExtLinkDialog(strLink,strTarget,externalLinksConfig);return false;});jQuery.fn.ShowExtLinkDialog=function(strLink,strTarget,options){var activeElem=document.activeElement;var fnCallback=null;if(arguments.length==4){if(typeof(arguments[3])=="function"){fnCallback=arguments[3];}}
var config={linkMsg:'',emailMsg:'',customMsgs:[],sizeClass:'',fadeClass:'',bShowLink:false,bFormatLink:true,backdrop:false,title:'Leave this website?',okText:'Ok',bShowClose:true,closeText:'Close',bCloseOnEsc:true,bShowTitleBarX:false};var options=jQuery.extend(config,options);if((strTarget=='')||(strTarget==undefined)){strTarget='_self';}
var isMailto=(strLink.match(/^mailto\:/))?true:false;var dialogMsg=(isMailto==true)?config.emailMsg:config.linkMsg;if(config.customMsgs!=''){for(var i=0;i<config.customMsgs.length;i++){if(strLink.toString().indexOf(config.customMsgs[i][0])!=-1){dialogMsg=config.customMsgs[i][1];}}}
var displayedLink='';if(config.bShowLink==true){displayedLink=strLink;if(isMailto==true){displayedLink=displayedLink.replace(/mailto:/,'');}
else{displayedLink=displayedLink.replace(/((\w)*:(\/){2})|(^(\/){2})/,'')}
if(config.bFormatLink==true){displayedLink=StripUrlEnd(displayedLink,/(\?|\/|\#)/);}}
dialogMsg=dialogMsg.replace(/\[link\]/,displayedLink);var extLinksModal=jQuery('#extLinksModal');var modalMarkup='<div class="modal-dialog">'+'<div class="modal-content">'+'<div class="modal-header">'+'<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+'<h4 class="modal-title" id="extLinksModalLabel">'+config.title+'</h4>'+'</div>'+'<div class="modal-body">'+dialogMsg+'</div>'+'<div class="modal-footer">'+'<button type="button" class="btn btn-default" data-dismiss="modal">'+config.closeText+'</button>'+'<a class="btn btn-primary">'+config.okText+'</a>'+'</div>'+'</div>'+'</div>';jQuery(extLinksModal).append(modalMarkup);jQuery(extLinksModal).addClass(config.fadeClass);jQuery(extLinksModal).attr('aria-labelledby','extLinksModalLabel');jQuery(extLinksModal).find('.modal-dialog').addClass(config.sizeClass);if(!config.bShowTitleBarX){jQuery(extLinksModal).find('.modal-header button.close').hide();}
if(!config.bShowClose){jQuery(extLinksModal).find('.btn-default').hide();}
jQuery(extLinksModal).on('shown.bs.modal',function(e){jQuery(this).find('.btn-primary').attr('href',strLink);if(isMailto!=true){jQuery(this).find('.btn-primary').attr('target',strTarget);}
var firstSelectableElem=config.bShowTitleBarX?'.close':(config.bShowClose?'.btn-default':'.btn-primary');jQuery(this).find(firstSelectableElem).focus();});jQuery(extLinksModal).on('hide.bs.modal',function(e){jQuery(this).removeAttr('aria-labelledby');jQuery(this).find('.modal-dialog').remove();});jQuery(extLinksModal).on('hidden.bs.modal',function(e){activeElem.focus();});jQuery(extLinksModal).on('click','.btn-primary',function(){jQuery(extLinksModal).modal('hide');});jQuery(extLinksModal).modal({backdrop:config.backdrop,keyboard:config.bCloseOnEsc,show:true});};});function OpenExternalLink(strURL,strTarget){var fnCallback=null;if(arguments.length==3){if(typeof(arguments[2])=="function"){fnCallback=arguments[2];}}
if(IsApprovedURL(strURL)){if(fnCallback!=null){fnCallback();}
window.open(strURL,strTarget);return false;}
else{jQuery(this).ShowExtLinkDialog(strURL,strTarget,externalLinksConfig,fnCallback);return false;}}
function JumpMenu(targ,selObj,restore){var strURL=selObj.options[selObj.selectedIndex].value;OpenExternalLink(strURL,targ);if(restore){selObj.selectedIndex=0;}}
function MM_jumpMenu(targ,selObj,restore){JumpMenu(targ,selObj,restore);}
function IsApprovedURL(strURL){strURL=strURL.toLowerCase();if((strURL.indexOf('http:')>-1)||(strURL.indexOf('https:')>-1)||(strURL.substring(0,2)=='\/\/')){if(IsInDomainList(approvedDomains,strURL)){return true;}}
else{return true;}
return false;}
function IsInDomainList(strDomainList,strURL){if(strDomainList!=''){var arrDomainList=strDomainList.toLowerCase().split(';');for(var i=0;i<arrDomainList.length;i++){if(strURL.indexOf(arrDomainList[i])!=-1){return true;}}}
return false;}
function StripUrlEnd(strUrl,re){var index=strUrl.search(re);if(index>=0){return strUrl.substring(0,index);}
return strUrl;}